# Ostia éƒ¨ç½²æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—å¸®åŠ©æ‚¨å¿«é€Ÿéƒ¨ç½² Ostia çš„ Nostr Relay å’Œ Blossom åª’ä½“æœåŠ¡å™¨ï¼Œå¹¶é…ç½®å®¢æˆ·ç«¯è¿æ¥ã€‚  
æœ¬æŒ‡å—åŸºäºé»˜è®¤ç«¯å£é…ç½®ï¼ˆ9200 æ–‡æœ¬ã€9300 åª’ä½“ + ADB åå‘ä»£ç†ï¼‰ã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹ (æ¨è)

### Windows
```powershell
cd D:\Ostia\deployment
.\å¿«é€Ÿå¼€å§‹.bat
```

### Linux/macOS
```bash
cd /path/to/ostia/deployment
./å¿«é€Ÿå¼€å§‹.sh
```

---

## ğŸ“¦ æ‰‹åŠ¨éƒ¨ç½²æ­¥éª¤

### ç¬¬ 1 æ­¥: å¯åŠ¨ Blossom åª’ä½“æœåŠ¡å™¨ï¼ˆNode.jsï¼‰

```bash
cd /d/Ostia/server
RUN.bat
```

Linux/macOSï¼š

```bash
cd /path/to/Ostia/server
node blossom-server.cjs
```

### ç¬¬ 2 æ­¥: å¯åŠ¨ Nostr Relayï¼ˆDockerï¼‰

```bash
cd deployment
docker-compose up -d nostr-relay
```

**ç«¯å£è¯´æ˜:**
- `9200` - Nostr Relay (æ–‡æœ¬æ¶ˆæ¯)
- `9300` - Blossom (å›¾ç‰‡/æ–‡ä»¶)

### ç¬¬ 3 æ­¥: é…ç½® Ostia å®¢æˆ·ç«¯

#### Windows/macOS/Linux å®¢æˆ·ç«¯
```
ä¸­ç»§å™¨: ws://localhost:9200
åª’ä½“æœåŠ¡å™¨: http://localhost:9300
```

#### Android æ¨¡æ‹Ÿå™¨ (ä½¿ç”¨ ADB åå‘ä»£ç†)
```bash
# è®¾ç½®ç«¯å£æ˜ å°„
adb reverse tcp:9200 tcp:9200
adb reverse tcp:9300 tcp:9300

# éªŒè¯æ˜ å°„
adb reverse --list

# åœ¨ Ostia ä¸­é…ç½®
ä¸­ç»§å™¨: ws://localhost:9200
åª’ä½“æœåŠ¡å™¨: http://localhost:9300
```

**Windows ç”¨æˆ·å¯ä½¿ç”¨:** `deployment\adb-port-forward.bat`

### ç¬¬ 3 æ­¥: é‡å¯ Ostia åº”ç”¨

ä¿®æ”¹é…ç½®å,éœ€è¦é‡å¯ Ostia åº”ç”¨ä»¥åº”ç”¨æ–°è®¾ç½®ã€‚

---

## ğŸ”§ é…ç½®è¯´æ˜

### ä¸­ç»§å™¨é…ç½®

**é»˜è®¤ä¸­ç»§å™¨:**
- å½“å‰ç‰ˆæœ¬ä¸å†…ç½®é»˜è®¤ä¸­ç»§å™¨ï¼Œéœ€è¦æ‰‹åŠ¨æ·»åŠ 

**åŠ¨æ€æ¨èä¸­ç»§å™¨:**
- å½“å‰ç‰ˆæœ¬ä¸ä¼šè‡ªåŠ¨è¿”å›æ¨èä¸­ç»§å™¨

### åª’ä½“æœåŠ¡å™¨é…ç½®

**é‡è¦:** åª’ä½“æœåŠ¡å™¨ä¸ä¸­ç»§å™¨æ˜¯**å®Œå…¨ç‹¬ç«‹**çš„é…ç½®ã€‚

- åª’ä½“æœåŠ¡å™¨ URL éœ€è¦**æ‰‹åŠ¨è®¾ç½®**
- ä¸ä¼šä»ä¸­ç»§å™¨é…ç½®ä¸­è‡ªåŠ¨æ¨å¯¼
- æ”¯æŒ http:// æˆ– https:// å¼€å¤´çš„ URL

---

## ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤

### Docker ç®¡ç†
```bash
# å¯åŠ¨æœåŠ¡
docker-compose up -d

# åœæ­¢æœåŠ¡
docker-compose down

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹çŠ¶æ€
docker-compose ps
```

### ADB ç®¡ç†
```bash
# æŸ¥çœ‹è®¾å¤‡
adb devices

# è®¾ç½®æ˜ å°„
adb reverse tcp:9200 tcp:9200
adb reverse tcp:9300 tcp:9300

# æŸ¥çœ‹æ˜ å°„
adb reverse --list

# æ¸…é™¤æ˜ å°„
adb reverse --remove tcp:9200
adb reverse --remove tcp:9300
```

### æµ‹è¯•è¿æ¥
```bash
# æµ‹è¯• Relay
curl http://localhost:9200

# æµ‹è¯• Blossom
curl http://localhost:9300/
```

---

## ğŸ“± å®¢æˆ·ç«¯é…ç½®æµç¨‹

### 1. Windows/macOS/Linux å®¢æˆ·ç«¯
```
1. æ‰“å¼€ Ostia åº”ç”¨
2. è¿›å…¥è®¾ç½®é¡µé¢
3. ä¸­ç»§å™¨: ws://localhost:9200
4. åª’ä½“æœåŠ¡å™¨: http://localhost:9300
5. ä¿å­˜å¹¶é‡å¯åº”ç”¨
```

### 2. Android çœŸæœº/æ¨¡æ‹Ÿå™¨
```
1. è¿æ¥è®¾å¤‡ (USB è°ƒè¯•å¼€å¯)
2. è¿è¡Œ: adb reverse tcp:9200 tcp:9200
3. è¿è¡Œ: adb reverse tcp:9300 tcp:9300
4. æ‰“å¼€ Ostia åº”ç”¨
5. ä¸­ç»§å™¨: ws://localhost:9200
6. åª’ä½“æœåŠ¡å™¨: http://localhost:9300
7. ä¿å­˜å¹¶é‡å¯åº”ç”¨
```

---

## ğŸ› æ•…éšœæ’æŸ¥

### æœåŠ¡æ— æ³•å¯åŠ¨
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -ano | findstr :9200  # Windows
lsof -i :9200                 # Linux/macOS

# æ£€æŸ¥ Docker æ—¥å¿—
docker-compose logs
```

### Android æ— æ³•è¿æ¥
```bash
# 1. æ£€æŸ¥ ADB
adb devices

# 2. è®¾ç½®æ˜ å°„
adb reverse tcp:9200 tcp:9200
adb reverse tcp:9300 tcp:9300

# 3. éªŒè¯
adb reverse --list
```

### æ¶ˆæ¯æ”¶ä¸åˆ°
1. æ£€æŸ¥ä¸¤å°è®¾å¤‡ä½¿ç”¨**ç›¸åŒ**çš„ä¸­ç»§å™¨åœ°å€
2. æ£€æŸ¥ä¸­ç»§å™¨åœ°å€æ ¼å¼ (ws:// å¼€å¤´)
3. é‡å¯ Ostia åº”ç”¨
4. æŸ¥çœ‹ Docker æ—¥å¿—: `docker-compose logs`

### å›¾ç‰‡æ— æ³•æ˜¾ç¤º
1. æ£€æŸ¥åª’ä½“æœåŠ¡å™¨é…ç½®æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤åª’ä½“æœåŠ¡å™¨ URL ä»¥ http:// æˆ– https:// å¼€å¤´
3. æ£€æŸ¥ Docker æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
4. æŸ¥çœ‹ Blossom æ—¥å¿—: æŸ¥çœ‹å¯åŠ¨çª—å£è¾“å‡º

---

## ğŸ“‚ æ–‡ä»¶è¯´æ˜

```
deployment/
â”œâ”€â”€ docker-compose.yml          # Docker æœåŠ¡ç¼–æ’
â”œâ”€â”€ relay-config.toml           # Nostr Relay é…ç½®
â”œâ”€â”€ docker-deploy.sh            # Linux/macOS éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ docker-deploy.bat           # Windows éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ adb-port-forward.sh         # Linux/macOS ADB æ˜ å°„
â”œâ”€â”€ adb-port-forward.bat        # Windows ADB æ˜ å°„
â”œâ”€â”€ QUICK_START.md              # å¿«é€Ÿå¼€å§‹
â””â”€â”€ README.md                   # éƒ¨ç½²è¯´æ˜
```

---

## ğŸ’¡ é‡è¦æç¤º

âœ… **æ‰€æœ‰å¹³å°ç»Ÿä¸€ä½¿ç”¨ `localhost`** (é…åˆ adb reverse)
âœ… **ç«¯å£ 9200** é¿å…ä¸å¸¸è§æœåŠ¡å†²çª
âœ… **ç«¯å£ 9300** ä¿æŒä¸å˜
âœ… **åª’ä½“æœåŠ¡å™¨éœ€è¦æ‰‹åŠ¨é…ç½®**, ä¸ä¼šè‡ªåŠ¨æ¨å¯¼
âœ… **ä¿®æ”¹ç«¯å£éœ€è¦æ›´æ–°æ‰€æœ‰é…ç½®**
âœ… **adb reverse æ˜ å°„åœ¨è®¾å¤‡æ–­å¼€åä¼šå¤±æ•ˆ**, éœ€é‡æ–°æ‰§è¡Œ

## ğŸ’¾ å­˜å‚¨ä¸æ¸…ç†

### å®¢æˆ·ç«¯æœ¬åœ°æ•°æ®åº“
- **æ‰‹åŠ¨æ¸…ç†**: è®¾ç½® â†’ å­˜å‚¨ ä¸­å¯æ‰§è¡Œæ¸…ç†æˆ–å‹ç¼©
- **æ—§æ¶ˆæ¯æ¸…ç†**: æ”¯æŒæ¸…ç† 30 å¤©å‰æ¶ˆæ¯

### Blossom åª’ä½“æ–‡ä»¶
- **å­˜å‚¨ä½ç½®**: `server/blob-storage/`
- **ä¿ç•™ç­–ç•¥**: å¯åŠ¨æ—¶æ¸…ç† + æ¯ 24 å°æ—¶æ¸…ç† 30 å¤©å‰æ–‡ä»¶
- **æ–‡ä»¶å¤§å°é™åˆ¶**: å®¢æˆ·ç«¯ä¸Šä¼ å‰é™åˆ¶ 25MB

### Nostr Relay æ•°æ®
- **å­˜å‚¨ä½ç½®**: `deployment/relay-data/`
- **æ¸…ç†ç­–ç•¥**: Docker å®¹å™¨ä¸è‡ªåŠ¨æ¸…ç†

---

## ğŸ“ è·å–å¸®åŠ©

è¯¦ç»†æ–‡æ¡£:
- `deployment/README-DOCKER.md` - å®Œæ•´éƒ¨ç½²æŒ‡å—
- `deployment/éƒ¨ç½²è¯´æ˜.md` - Ostia é…ç½®è¯´æ˜
- `deployment/å¿«é€Ÿå‚è€ƒ.md` - å‘½ä»¤é€ŸæŸ¥è¡¨
- `deployment/å­˜å‚¨ç­–ç•¥è¯´æ˜.md` - å­˜å‚¨å’Œæ¸…ç†æœºåˆ¶
- `deployment/docker-compose.yml` - æœåŠ¡é…ç½®

---

## ğŸ” éªŒè¯éƒ¨ç½²

### 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€
```bash
docker-compose ps
```

é¢„æœŸè¾“å‡º:
```
NAME                COMMAND                  STATUS
ostia-relay         "/usr/local/bin/nostrâ€¦"   Up
ostia-blossom       "/usr/local/bin/blosâ€¦"   Up
```

### 2. æµ‹è¯• Relay
```bash
curl http://localhost:9200
```
åº”è¿”å› Nostr Relay ä¿¡æ¯

### 3. æµ‹è¯• Blossom
```bash
curl http://localhost:9300/health
```
åº”è¿”å› `{"status":"ok"}`

### 4. å®¢æˆ·ç«¯æµ‹è¯•
- ä¸¤å°è®¾å¤‡äº’ç›¸æ·»åŠ å¥½å‹
- å‘é€æ–‡æœ¬æ¶ˆæ¯
- å‘é€å›¾ç‰‡æ¶ˆæ¯
- éªŒè¯åŒæ–¹éƒ½èƒ½æ­£å¸¸æ”¶å‘

---

## ğŸ¯ éƒ¨ç½²æ¸…å•

- [ ] å¯åŠ¨ Docker æœåŠ¡ (`docker-compose up -d`)
- [ ] é…ç½®ä¸­ç»§å™¨: `ws://localhost:9200`
- [ ] é…ç½®åª’ä½“æœåŠ¡å™¨: `http://localhost:9300`
- [ ] Android: æ‰§è¡Œ `adb reverse` æ˜ å°„
- [ ] é‡å¯ Ostia åº”ç”¨
- [ ] æ·»åŠ è”ç³»äºº
- [ ] æµ‹è¯•æ–‡æœ¬æ¶ˆæ¯
- [ ] æµ‹è¯•å›¾ç‰‡æ¶ˆæ¯

---

**éƒ¨ç½²å®Œæˆ!** ğŸ‰

å¦‚é‡åˆ°é—®é¢˜,è¯·æŸ¥çœ‹ `deployment/README-DOCKER.md` æˆ–è”ç³»å¼€å‘è€…ã€‚
